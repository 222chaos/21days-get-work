# 基于slate的高级table

## 1. 背景
目前 table 组件支持基础的内容编辑，但缺乏对整行、整列及整个表格的快速操作功能，包括选中、添加、删除等。为提升用户在复杂表格操作场景中的便捷性和效率，需要新增以下功能：通过侧边栏、顶栏快速选中整行或整列，同时支持基于 hover 提示新建行/列以及删除选中的行/列。

---

## 2. 目标
1. 用户可以通过点击表格侧边栏快速选中整行。
2. 用户可以通过点击表格顶栏快速选中整列。
3. 用户可以通过点击表格左上角的控制点快速选中整个表格。
4. 用户 hover 至侧边栏或顶栏时，显示可交互的添加按钮。
5. 用户点击添加按钮，可以在目标位置（上下/左右）添加空行或空列。
6. 用户选中行或列后，可显示删除按钮并支持删除选中的行或列。

---

## 3. 功能需求

### 3.1 核心功能描述

#### 选中整行
1. 用户点击表格侧边栏的行号区域，可以选中整行单元格。
2. 选中状态下，侧边栏区域与对应的行高亮显示，并在侧边栏右侧显示删除按钮。

#### 选中整列
1. 用户点击表格顶栏的列号区域，可以选中整列单元格。
2. 选中状态下，顶栏区域与对应的列高亮显示，并在顶栏上方显示删除按钮。

#### 选中整个表格
1. 用户点击表格左上角的控制点，可以选中整个表格。
2. 选中状态下，整个表格的所有单元格高亮。

#### 添加空行/空列
1. 用户 hover 至侧边栏或顶栏时，在对应 hover 区域的上下（行）或左右（列）显示添加按钮。
2. 点击添加按钮后，在目标位置添加一行或一列空白单元格。

#### 删除选中行/列
1. 用户选中行或列后，在侧边栏或顶栏显示删除按钮。
2. 点击删除按钮后，删除选中的行或列。

---

## 4. 技术需求

### 4.1 DOM 操作
- 基于现有 DOM 结构实现行列操作：
  - 使用 `ReactEditor.toDOMNode` 或 `tableTargetRef` 获取行/列的 DOM 元素。
  - 修改对应行/列的样式实现高亮和选中效果。
- 行列选中状态管理：
  - 新增状态字段 `selectRows` 和 `selectCols`，管理当前选中行列。
  - 根据状态动态更新行列 DOM 的 `className` 和样式。

### 4.2 事件处理
#### Hover 事件
- 监听行号或列号的 hover 状态，并动态渲染 `+` 添加按钮。

#### 点击事件
1. **行列号点击**
   - 触发选中状态更新。
2. **+ 按钮点击**
   - 基于当前目标位置插入行或列。
3. **删除按钮点击**
   - 移除对应行或列的 DOM。

#### 交互约束
- 限制用户的无效操作，如超出表格范围、删除过多行列等。

### 4.3 样式实现

#### 高亮样式
- 选中行/列后，动态添加样式类 `selected-row` 和 `selected-col`。
- 左上角控制点在表格选中时添加样式类 `selected-table`。

#### 按钮样式
1. **添加按钮**
   - hover 时动态显示。
2. **删除按钮**
   - 选中行/列后动态显示。

---
